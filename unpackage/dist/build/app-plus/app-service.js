if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t="tf24_users_v1",n="tf24_stats_v1";function l(e,t){try{const n=uni.getStorageSync(e);return n?"string"==typeof n?JSON.parse(n):n:t}catch(n){return t}}function a(e,t){try{uni.setStorageSync(e,JSON.stringify(t))}catch(n){}}function o(){const e=l(t,null);if(e&&"object"==typeof e&&Array.isArray(e.list)){const n={...e};n.list=(e.list||[]).map((e=>({id:e.id||v(),name:e.name||"玩家",avatar:e.avatar||"",color:e.color||p(),createdAt:e.createdAt||Date.now(),lastPlayedAt:e.lastPlayedAt||0})));const l=new Set(n.list.filter((e=>"Guest"===String(e.name||""))).map((e=>e.id)));l.size>0&&(n.list=n.list.filter((e=>!l.has(e.id))),l.has(n.currentId)&&(n.currentId=n.list[0]&&n.list[0].id||"")),n!==e&&a(t,n)}else a(t,{list:[],currentId:""});const o=l(n,null);o&&"object"==typeof o||a(n,{})}function s(){return l(t,{list:[],currentId:""})}function r(e){a(t,e)}function i(e){const t=s();t.list.find((t=>t.id===e))&&(t.currentId=e,r(t))}function c(e,t="",n){var l;const a=s(),o=v(),i={id:o,name:e||`玩家${((null==(l=a.list)?void 0:l.length)||0)+1}`,avatar:t||"",color:n||p(),createdAt:Date.now(),lastPlayedAt:0};return a.list=(a.list||[]).concat([i]),a.currentId||(a.currentId=o),r(a),o}function u(e){const t=s().currentId;if(!t)return;const o=l(n,{});o[t]||(o[t]={totals:{total:0,success:0,fail:0},days:{}});const i=(new Date).toISOString().slice(0,10);o[t].days[i]||(o[t].days[i]={total:0,success:0,fail:0}),o[t].totals.total+=1,o[t].days[i].total+=1,e?(o[t].totals.success+=1,o[t].days[i].success+=1):(o[t].totals.fail+=1,o[t].days[i].fail+=1),a(n,o);try{const e=s(),n=(e.list||[]).find((e=>e.id===t));n&&(n.lastPlayedAt=Date.now(),r(e))}catch(c){}}function d(e){try{const t=s(),n=e||t.currentId;if(!n)return;const l=(t.list||[]).find((e=>e.id===n));l&&(l.lastPlayedAt=Date.now(),r(t))}catch(t){}}function v(){return Math.random().toString(36).slice(2,10)}function p(){const e=["#e2e8f0","#fde68a","#bbf7d0","#bfdbfe","#fecaca","#f5d0fe","#c7d2fe"];return e[Math.floor(Math.random()*e.length)]}const m=(e,t)=>{const n=e.__vccOpts||e;for(const[l,a]of t)n[l]=a;return n},f=m({__name:"index",setup(t){const n=e.ref({list:[],currentId:""}),l=e.ref("");function a(){try{const e=s();if(!e||!Array.isArray(e.list)||void 0===e.currentId)throw new Error("本地用户数据结构无效");n.value=e}catch(e){l.value=e&&e.message?e.message:"本地存储损坏"}}e.onMounted((()=>{o(),a()}));const r=e.computed((()=>{const e=(n.value.list||[]).filter((e=>"Guest"!==String(e.name||""))).slice();return e.sort(((e,t)=>(t.lastPlayedAt||0)-(e.lastPlayedAt||0)||(t.createdAt||0)-(e.createdAt||0))),e}));function u(e){if(["/pages/index/index","/pages/stats/index","/pages/user/index"].includes(e))try{uni.switchTab({url:e})}catch(t){}else try{uni.reLaunch({url:e})}catch(n){try{uni.navigateTo({url:e})}catch(t){}}}function v(){try{uni.navigateBack()}catch(e){u("/pages/index/index")}}function p(){uni.showModal({title:"新建玩家",editable:!0,placeholderText:"昵称（1-20字）",success(e){if(!e.confirm)return;const t=String(e.content||"").trim();if(!t||t.length<1||t.length>20)return void uni.showToast({title:"请输入1-20字昵称",icon:"none"});(n.value.list||[]).some((e=>String(e.name||"").toLowerCase()===t.toLowerCase()))?uni.showModal({title:"提示",content:"已有同名玩家，是否继续创建？",success(e){e.confirm?m(t):p()}}):m(t)}})}function m(e){uni.showActionSheet({itemList:["从相册选择","随机分配","跳过"],success(t){const n=t.tapIndex;0===n?uni.chooseImage({count:1,sizeType:["compressed"],success(t){const n=t.tempFilePaths&&t.tempFilePaths[0]||"";f(e,n)},fail(){f(e,"")}}):f(e,"")},fail(){f(e,"")}})}function f(e,t){const n=c(e,t);i(n),d(n),u("/pages/index/index")}function h(){u("/pages/index/index")}function g(e){if(!e)return"U";const t=String(e).trim();return t.length?t[0].toUpperCase():"U"}function y(e){if(!e)return"从未游玩";try{const t=new Date(e),n=Date.now(),l=new Date,a=t.toDateString()===l.toDateString(),o=t.getFullYear(),s=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),i=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0");if(a)return`今天 ${i}:${c}`;const u=new Date(n-864e5);return t.toDateString()===u.toDateString()?`昨天 ${i}:${c}`:`${o}-${s}-${r} ${i}:${c}`}catch(t){return"时间未知"}}function x(e){const t=String(e.id||e.name||"");let n=0;for(let a=0;a<t.length;a++)n=33*n+t.charCodeAt(a)>>>0;const l=["#e2e8f0","#fde68a","#bbf7d0","#bfdbfe","#fecaca","#f5d0fe","#c7d2fe"];return l[n%l.length]}function k(){uni.showModal({title:"重置数据",content:"将清空本地所有数据，是否继续？",success(e){e.confirm&&(!function(){try{uni.clearStorageSync()}catch(e){}o()}(),l.value="",a())}})}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"login-page"},[e.createElementVNode("view",{class:"login-topbar"},[e.createElementVNode("button",{class:"icon-btn",onClick:v},"←"),e.createElementVNode("text",{class:"login-title"},"24 Point Game"),e.createElementVNode("view",{style:{width:"40rpx"}})]),e.createElementVNode("view",{class:"login-body"},[e.createElementVNode("view",{class:"login-heading"},[e.createElementVNode("text",{class:"h1"},"选择玩家"),e.createElementVNode("text",{class:"sub"},"点击玩家进入游戏")]),l.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-card"},[e.createElementVNode("text",{class:"err-title"},"数据异常"),e.createElementVNode("text",{class:"err-text"},e.toDisplayString(l.value),1),e.createElementVNode("button",{class:"btn danger",onClick:k},"重置数据")])):0===r.value.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-card"},[e.createElementVNode("text",{class:"empty-ill"},"🃏"),e.createElementVNode("text",{class:"empty-text"},"还没有玩家，快创建一个吧！"),e.createElementVNode("button",{class:"create-btn highlight",onClick:p},[e.createElementVNode("text",{class:"create-plus"},"＋"),e.createElementVNode("text",null,"新建玩家")])])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"user-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,(t=>(e.openBlock(),e.createElementBlock("button",{class:"user-item",key:t.id,onClick:e=>function(e){i(e.id),d(e.id),u("/pages/index/index")}(t)},[t.avatar?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-img",src:t.avatar,mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"avatar",style:e.normalizeStyle({backgroundColor:t.color||x(t)})},e.toDisplayString(g(t.name)),5)),e.createElementVNode("view",{class:"user-col"},[e.createElementVNode("text",{class:"user-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"user-sub"},"最近游戏："+e.toDisplayString(y(t.lastPlayedAt)),1)]),e.createElementVNode("text",{class:"chev"},"›")],8,["onClick"])))),128)),e.createElementVNode("button",{class:"create-btn",onClick:p},[e.createElementVNode("text",{class:"create-plus"},"＋"),e.createElementVNode("text",null,"新建玩家")])]))]),e.createElementVNode("view",{class:"login-footer"},[e.createElementVNode("view",{class:"or-row"},[e.createElementVNode("view",{class:"line"}),e.createElementVNode("text",{class:"or"},"也可以"),e.createElementVNode("view",{class:"line"})]),e.createElementVNode("button",{class:"guest-btn",onClick:h},"以游客登录")])]))}},[["__scopeId","data-v-6c483b32"]]);class h{constructor(e,t){if(0===t)throw new Error("denominator 0");this.n=e,this.d=t,this.normSelf()}static fromInt(e){return new h(e,1)}normSelf(){let e=this.n,t=this.d;t<0&&(e=-e,t=-t);const n=function(e,t){for(e=Math.abs(e),t=Math.abs(t);0!==t;){const n=e%t;e=t,t=n}return 0===e?1:Math.abs(e)}(Math.abs(e),Math.abs(t));this.n=e/n,this.d=t/n}plus(e){return new h(this.n*e.d+e.n*this.d,this.d*e.d)}minus(e){return new h(this.n*e.d-e.n*this.d,this.d*e.d)}times(e){return new h(this.n*e.n,this.d*e.d)}div(e){if(0===e.n)throw new Error("divide by zero");return new h(this.n*e.d,this.d*e.n)}equalsInt(e){return this.n===e*this.d}toString(){return 1===this.d?String(this.n):`${this.n}/${this.d}`}}function g(e){if(!e||4!==e.length)throw new Error("need 4 numbers");const t=y(e.map((e=>({v:h.fromInt(e),expr:String(e)}))));return t?t.expr:null}function y(e){if(1===e.length)return e[0].v.equalsInt(24)?e[0]:null;for(let t=0;t<e.length;t++)for(let n=0;n<e.length;n++){if(t===n)continue;const l=[];for(let s=0;s<e.length;s++)s!==t&&s!==n&&l.push(e[s]);const a=e[t],o=e[n];{const e={v:a.v.plus(o.v),expr:`(${a.expr}+${o.expr})`},t=y(l.concat([e]));if(t)return t}{const e={v:a.v.minus(o.v),expr:`(${a.expr}-${o.expr})`},t=y(l.concat([e]));if(t)return t}{const e={v:a.v.times(o.v),expr:`(${a.expr}×${o.expr})`},t=y(l.concat([e]));if(t)return t}if(0!==o.v.n){const e={v:a.v.div(o.v),expr:`(${a.expr}÷${o.expr})`},t=y(l.concat([e]));if(t)return t}}return null}function x(e){const t=[];let n=0;for(;n<e.length;){const l=e[n];if(/\s/.test(l))n++;else if("()+-×÷".includes(l))t.push({t:l}),n++;else{if(!/\d/.test(l))return null;{let l=n+1;for(;l<e.length&&/\d/.test(e[l]);)l++;t.push({t:e.slice(n,l)}),n=l}}}const l=e=>"+"===e||"-"===e?1:"×"===e||"÷"===e?2:0,a=[],o=[];for(const r of t)if(/^\d/.test(r.t))a.push(r);else if("("===r.t)o.push(r);else if(")"===r.t){for(;o.length&&"("!==o[o.length-1].t;)a.push(o.pop());if(!o.length||"("!==o[o.length-1].t)return null;o.pop()}else{if(!"+-×÷".includes(r.t))return null;for(;o.length;){const e=o[o.length-1].t;if(!("+-×÷".includes(e)&&l(e)>=l(r.t)))break;a.push(o.pop())}o.push(r)}for(;o.length;){const e=o.pop();if("("===e.t)return null;a.push(e)}const s=[];for(const r of a)if(/^\d/.test(r.t))s.push(h.fromInt(parseInt(r.t)));else{if(s.length<2)return null;const e=s.pop(),t=s.pop();let n;if("+"===r.t)n=t.plus(e);else if("-"===r.t)n=t.minus(e);else if("×"===r.t)n=t.times(e);else{if("÷"!==r.t)return null;if(0===e.n)return null;n=t.div(e)}s.push(n)}return 1===s.length?s[0]:null}const k=m({__name:"index",setup(t){const n=e.ref([{rank:1,suit:"S"},{rank:5,suit:"H"},{rank:5,suit:"D"},{rank:5,suit:"C"}]),l=e.ref(null),a=e.ref(""),r=e.ref([0,0,0,0]),i=e.ref([]),c=e.ref(!1),d=e.ref(!1),v=e.ref(200),p=e.ref(null),m=e.ref([]),f=e.ref(0),h=e.ref(0),y=e.ref(0),k=e.ref(!1),w=e.computed((()=>(m.value||[]).length)),E=e.computed((()=>{const e=h.value+y.value;return e?Math.round(100*h.value/e):0})),b=e.ref({active:!1,token:null,x:0,y:0,startX:0,startY:0,moved:!1}),V=e.ref({left:0,top:0,right:0,bottom:0}),N=e.ref([]),S=e.ref(-1),B=e.ref(-1),{proxy:C}=e.getCurrentInstance(),I=e.ref(!1),M=e.computed((()=>i.value.map((e=>"num"===e.type?String(se(e.rank??+e.value)):e.value)).join(""))),A=e.computed((()=>`left:${b.value.x}px; top:${b.value.y}px;`)),T=e.ref(1),D=e.ref("normal"),_=e.computed((()=>"tight"===D.value?"ops-tight":"compact"===D.value?"ops-compact":"")),$=e.computed((()=>{const e=b.value.token;return e?"num"===e.type?re(e.rank||+e.value):"tok"===e.type?/^(10|11|12|13|[1-9])$/.test(e.value)?re(+e.value):e.value:e.value||"":""})),R=e.computed((()=>{const e=b.value.token;return b.value.active&&e?"num"===e.type?"num":"op"===e.type?"op":"tok"===e.type&&/^(10|11|12|13|[1-9])$/.test(e.value)?"num":"op":"op"})),z=e.computed((()=>{const e=M.value;if(!e)return"";const t=x(e);return t?`${t.toString()}`:""}));function P(){const e=["S","H","D","C"],t=[];for(const n of e)for(let e=1;e<=13;e++)t.push({rank:e,suit:n});for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}m.value=t}function F(){if(!m.value||m.value.length<4)return k.value=!0,a.value="牌库不足，已结束本局",void ce();const t=Math.min(200,1+m.value.length*m.value.length);let o=null;for(let e=0;e<t;e++){const e=new Set;for(;e.size<4;)e.add(Math.floor(Math.random()*m.value.length));const t=Array.from(e),n=g(t.map((e=>m.value[e])).map((e=>se(e.rank))));if(n){o={ids:t,sol:n};break}}if(!o)return k.value=!0,a.value="本副牌无可解手牌，已结束本局",void ce();const s=o.ids.sort(((e,t)=>t-e)),c=[];for(const e of s)c.unshift(m.value[e]),m.value.splice(e,1);n.value=c,l.value=o.sol,i.value=[],r.value=[0,0,0,0],d.value=!1,a.value="拖入 + - × ÷ ( ) 组成 24",e.nextTick((()=>oe()))}function U(){i.value=[],r.value=[0,0,0,0]}function L(){if(4!==r.value.reduce(((e,t)=>e+(t?1:0)),0))return void(a.value="请先使用四张牌再提交");const e=x(M.value),t=e&&e.equalsInt&&e.equalsInt(24);a.value=t?"恭喜，得到 24！":"未得到 24，再试试";try{u(!!t)}catch(n){}if(t&&!d.value){d.value=!0,f.value+=1,h.value+=1;try{u(!0)}catch(n){}}}function H(){if(!d.value){d.value=!0,f.value+=1,y.value+=1;try{u(!1)}catch(e){}}a.value=l.value?"答案："+l.value:"暂无提示"}function G(){c.value=!c.value}function Q(){if(!d.value){d.value=!0,f.value+=1,y.value+=1;try{u(!1)}catch(e){}}F()}function j(){try{uni.reLaunch({url:"/pages/login/index"})}catch(e){try{uni.navigateTo({url:"/pages/login/index"})}catch(t){}}}function q(e,t){b.value.active=!0,b.value.token=e;const n=ee(t);b.value.x=n.x,b.value.y=n.y,b.value.startX=n.x,b.value.startY=n.y,b.value.moved=!1,Z()}function J(e){if(!b.value.active)return;const t=ee(e);b.value.x=t.x,b.value.y=t.y;const n=b.value.x-b.value.startX,l=b.value.y-b.value.startY;!b.value.moved&&n*n+l*l>16&&(b.value.moved=!0);const a=b.value.token;if(a&&"tok"===a.type){const e=b.value.x,t=b.value.y;if(W(V.value,e,t)){const n=ne(e,t);n!==a.index&&n!==a.index+1&&(le(a.index,n),a.index=n>a.index?n-1:n,Z()),S.value=n}else S.value=-1}else{const e=b.value.x,t=b.value.y,n=W(V.value,e,t);S.value=n?ne(e,t):-1}}e.onMounted((()=>{o(),p.value=function(){const e=s();return e.list.find((t=>t.id===e.currentId))}()||null,P(),F(),setTimeout((()=>{I.value=!0}),0),e.nextTick((()=>{ae(),oe(),te()})),uni.onWindowResize&&uni.onWindowResize((()=>{ae(),te(),oe()}))}));const O=e.ref({time:0,key:""});function Y(){if(!b.value.active)return;const e=b.value.x,t=b.value.y,n=b.value.token,l=W(V.value,e,t);if(n&&!b.value.moved){const e=Date.now(),t=function(e){return e?"num"===e.type&&null!=e.cardIndex?`num-${e.cardIndex}`:"op"===e.type?`op-${e.value}`:"tok"===e.type?`tok-${e.index}`:`${e.type}-${e.value||""}`:""}(n);return e-(O.value.time||0)<300&&O.value.key===t?("tok"===n.type?X(n.index):"num"!==n.type&&"op"!==n.type||(!function(e){K(e,i.value.length)}(n),B.value=Math.max(0,i.value.length-1),setTimeout((()=>{B.value=-1}),220)),O.value={time:0,key:""},b.value.active=!1,b.value.token=null,void(S.value=-1)):(O.value={time:e,key:t},b.value.active=!1,b.value.token=null,void(S.value=-1))}if(n&&"tok"===n.type)if(l){const l=ne(e,t);le(n.index,l),B.value=Math.max(0,Math.min(l,i.value.length-1)),setTimeout((()=>{B.value=-1}),220)}else X(n.index);else if(l&&n){const l=ne(e,t);K(n,l),B.value=Math.max(0,Math.min(l,i.value.length-1)),setTimeout((()=>{B.value=-1}),220)}b.value.active=!1,b.value.token=null,S.value=-1}function K(e,t){const n=Math.max(0,Math.min(t,i.value.length));if("num"===e.type){const t=e.cardIndex;if(null==t)return void(a.value="请选择一张牌");if((r.value[t]||0)>=1)return void(a.value="该牌已使用");const l=i.value.slice();l.splice(n,0,{type:"num",value:e.value,rank:e.rank,suit:e.suit,cardIndex:t}),i.value=l;const o=r.value.slice();o[t]=1,r.value=o}else if("op"===e.type){const t=i.value.slice();t.splice(n,0,{type:"op",value:e.value}),i.value=t}}function X(e){if(e<0||e>=i.value.length)return;const t=i.value[e];if(t&&"num"===t.type&&null!=t.cardIndex){const e=r.value.slice();e[t.cardIndex]=0,r.value=e}i.value=i.value.slice(0,e).concat(i.value.slice(e+1))}function Z(){uni.createSelectorQuery().in(C).select("#exprZone").boundingClientRect().selectAll(".tok").boundingClientRect().exec((e=>{const[t,n]=e||[];t&&(V.value={left:t.left,top:t.top,right:t.right,bottom:t.bottom}),N.value=n||[]}))}function W(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}function ee(e){const t=e&&e.touches&&e.touches[0]||e&&e.changedTouches&&e.changedTouches[0]||e&&e.detail||{x:0,y:0};return{x:t.clientX??t.x??0,y:t.clientY??t.y??0}}function te(){T.value=1,e.nextTick((()=>{uni.createSelectorQuery().in(C).select("#exprZone").boundingClientRect().select("#exprRow").boundingClientRect().exec((e=>{const[t,n]=e||[];if(!t||!n)return;const l=t.width-24,a=n.width||0;if(l>0&&a>0){const e=Math.min(1,l/a);T.value=isFinite(e)&&e>0?e:1}else T.value=1}))}))}function ne(e,t){const n=N.value||[];if(!n.length)return i.value.length;let l=0,a=1/0;for(let s=0;s<n.length;s++){const o=n[s],r=o.left+o.width/2-e,i=o.top+o.height/2-t,c=r*r+i*i;c<a&&(a=c,l=s)}const o=n[l];return e<o.left+o.width/2?l:l+1}function le(e,t){if(e===t)return;const n=i.value.slice(),l=n.splice(e,1)[0],a=Math.max(0,Math.min(t,n.length));n.splice(a,0,l),i.value=n}function ae(){try{const e=(uni.getSystemInfoSync&&uni.getSystemInfoSync()||{}).windowHeight||("undefined"!=typeof window?window.innerHeight:0)||0;e&&document.documentElement&&document.documentElement.style.setProperty("--vh",.01*e+"px")}catch(e){}}function oe(){const t=uni.getSystemInfoSync&&uni.getSystemInfoSync()||{},n=t.windowHeight||t.screenHeight||0;D.value=n&&n<640?"tight":n&&n<740?"compact":"normal",e.nextTick((()=>{uni.createSelectorQuery().in(C).select("#exprZone").boundingClientRect().select("#hintText").boundingClientRect().select("#opsRow1").boundingClientRect().select("#opsRow2").boundingClientRect().select("#submitRow").boundingClientRect().select("#failRow").boundingClientRect().exec((e=>{const[t,l,a,o,s,r]=e||[];if(!t)return;const i=l&&l.height||0,c=a&&a.height||0,u=o&&o.height||0,d=s&&s.height||0,p=r&&r.height||0;let m=n-(t.top||0)-(i+c+u+d+p)-12;(!isFinite(m)||m<=0)&&(m=120),v.value=Math.max(120,Math.floor(m))}))}))}function se(e){return 1===e?1:11===e||12===e||13===e?c.value?e:1:e}function re(e){return 1===e?"A":11===e?"J":12===e?"Q":13===e?"K":String(e)}function ie(e){return`/static/cards/${{S:"Spade",H:"Heart",D:"Diamond",C:"Club"}[e.suit]||"Spade"}${{1:"A",11:"J",12:"Q",13:"K"}[e.rank]||String(e.rank)}.png`}function ce(){try{uni.showModal({title:"本局结束",content:`次数：${f.value}\n成功：${h.value}\n胜率：${E.value}%\n是否开始下一局？`,confirmText:"下一局",cancelText:"统计",success:t=>{if(t.confirm)P(),f.value=0,h.value=0,y.value=0,d.value=!1,k.value=!1,e.nextTick((()=>F()));else try{uni.navigateTo({url:"/pages/stats/index"})}catch(n){}}})}catch(t){}}return e.watch(i,(()=>te())),(t,l)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["page col",{booted:I.value}]),style:{padding:"24rpx",gap:"24rpx",position:"relative"}},[e.createElementVNode("view",{class:"topbar",style:{display:"flex","align-items":"center","justify-content":"space-between",gap:"12rpx",background:"transparent",border:"none"}},[e.createElementVNode("text",{class:"topbar-title",style:{"text-align":"left",flex:"1"}},"当前用户："+e.toDisplayString(p.value&&p.value.name?p.value.name:"未选择"),1),e.createElementVNode("button",{class:"btn btn-secondary",style:{padding:"16rpx 20rpx",width:"auto"},onClick:j},"切换用户")]),e.createElementVNode("view",{id:"cardGrid",class:"card-grid",style:{"padding-top":"50rpx"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass(["card",{used:(r.value[n]||0)>0}]),onTouchstart:e.withModifiers((e=>q({type:"num",value:String(t.rank),rank:t.rank,suit:t.suit,cardIndex:n},e)),["stop","prevent"]),onTouchmove:l[0]||(l[0]=e.withModifiers((e=>J(e)),["stop","prevent"])),onTouchend:l[1]||(l[1]=e.withModifiers((e=>Y()),["stop","prevent"]))},[e.createElementVNode("image",{class:"card-img",src:ie(t),mode:"widthFix"},null,8,["src"])],42,["onTouchstart"])))),128))]),e.createElementVNode("view",{id:"statsRow",class:"stats-card stats-one-line"},[e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stat-label"},"剩余"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(w.value),1)]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stat-label"},"次数"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(f.value),1)]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stat-label ok"},"成功"),e.createElementVNode("text",{class:"stat-value ok"},e.toDisplayString(h.value),1)]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stat-label fail"},"失败"),e.createElementVNode("text",{class:"stat-value fail"},e.toDisplayString(y.value),1)]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stat-label"},"胜率"),e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(E.value)+"%",1)])]),e.createElementVNode("view",{class:"expr-card"},[e.createElementVNode("view",{class:"expr-title"},[e.createTextVNode("当前表达式："),e.createElementVNode("text",{class:"status-text"},e.toDisplayString(z.value?z.value:"未完成"),1)]),e.createElementVNode("view",{id:"exprZone",class:e.normalizeClass(["expr-zone",{"expr-zone-active":b.value.active}]),style:e.normalizeStyle({height:v.value+"px"})},[0===i.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"expr-placeholder"},"将卡牌和运算符拖到这里")):e.createCommentVNode("",!0),e.createElementVNode("view",{id:"exprRow",class:"row expr-row",style:e.normalizeStyle({transform:"scale("+T.value+")",transformOrigin:"left center"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,((t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[S.value===n?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["insert-placeholder",R.value])},null,2)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["tok",["num"===t.type?"num":"op",{"just-inserted":n===B.value,dragging:b.value.token&&"tok"===b.value.token.type&&b.value.token.index===n}]]),onTouchstart:e.withModifiers((e=>q({type:"tok",index:n,value:t.value},e)),["stop","prevent"]),onTouchmove:l[2]||(l[2]=e.withModifiers((e=>J(e)),["stop","prevent"])),onTouchend:l[3]||(l[3]=e.withModifiers((e=>Y()),["stop","prevent"]))},["num"===t.type?(e.openBlock(),e.createElementBlock("image",{key:0,class:"tok-card-img",src:ie({rank:t.rank||+t.value,suit:t.suit||"S"}),mode:"heightFix"},null,8,["src"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"tok-op-text"},e.toDisplayString(t.value),1))],42,["onTouchstart"])],64)))),128)),S.value===i.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["insert-placeholder",R.value])},null,2)):e.createCommentVNode("",!0)],4)],6)]),e.createElementVNode("text",{id:"hintText",class:"hint-text"},e.toDisplayString(a.value||"请用四张牌和运算符算出24"),1),e.createElementVNode("view",{id:"opsRow1",class:e.normalizeClass(["ops-row-1",_.value])},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["+","-","×","÷"],(t=>e.createElementVNode("button",{key:t,class:"btn btn-operator",onTouchstart:e.withModifiers((e=>q({type:"op",value:t},e)),["stop","prevent"]),onTouchmove:l[4]||(l[4]=e.withModifiers((e=>J(e)),["stop","prevent"])),onTouchend:l[5]||(l[5]=e.withModifiers((e=>Y()),["stop","prevent"]))},e.toDisplayString(t),41,["onTouchstart"]))),64))],2),e.createElementVNode("view",{id:"opsRow2",class:e.normalizeClass(["ops-row-2",_.value])},[e.createElementVNode("view",{class:"ops-left"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["(",")"],(t=>e.createElementVNode("button",{key:t,class:"btn btn-operator",onTouchstart:e.withModifiers((e=>q({type:"op",value:t},e)),["stop","prevent"]),onTouchmove:l[6]||(l[6]=e.withModifiers((e=>J(e)),["stop","prevent"])),onTouchend:l[7]||(l[7]=e.withModifiers((e=>Y()),["stop","prevent"]))},e.toDisplayString(t),41,["onTouchstart"]))),64))]),e.createElementVNode("button",{class:"btn btn-secondary mode-btn",onClick:G},e.toDisplayString(c.value?"J/Q/K=11/12/13":"J/Q/K=1"),1)],2),b.value.active?(e.openBlock(),e.createElementBlock("view",{key:0,class:"drag-ghost",style:e.normalizeStyle(A.value)},e.toDisplayString($.value),5)):e.createCommentVNode("",!0),e.createElementVNode("view",{id:"submitRow",class:"pair-grid"},[e.createElementVNode("button",{class:"btn btn-primary",onClick:L},"提交答案"),e.createElementVNode("button",{class:"btn btn-primary",onClick:U},"清空表达式")]),e.createElementVNode("view",{id:"failRow",class:"pair-grid"},[e.createElementVNode("button",{class:"btn btn-secondary",onClick:H},"答案"),e.createElementVNode("button",{class:"btn btn-secondary",onClick:Q},"换题")])],2))}},[["__scopeId","data-v-2d290044"]]),w=m({__name:"index",setup(t){const n=e.ref({list:[],currentId:""}),l=e.ref(""),a=e.computed((()=>(n.value.list||[]).filter((e=>"Guest"!==String(e.name||"")))));function u(){n.value=s()}function d(){c(l.value.trim()||void 0),l.value="",u()}function v(e){uni.showModal({title:"改名",editable:!0,placeholderText:e.name,success(t){t.confirm&&(!function(e,t){const n=s(),l=n.list.find((t=>t.id===e));l&&(l.name=t,r(n))}(e.id,t.content||e.name),u())}})}function p(e){uni.showModal({title:"删除用户",content:"确定删除该用户？",success(t){t.confirm&&(!function(e){const t=s();t.list=t.list.filter((t=>t.id!==e)),t.currentId===e&&(t.currentId=t.list[0]&&t.list[0].id||""),r(t)}(e),u())}})}return e.onMounted((()=>{o(),n.value=s()})),(t,o)=>(e.openBlock(),e.createElementBlock("view",{class:"page",style:{padding:"24rpx",display:"flex","flex-direction":"column",gap:"16rpx"}},[e.createElementVNode("view",{class:"row",style:{gap:"12rpx","align-items":"center"}},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),placeholder:"新用户名称",class:"input"},null,512),[[e.vModelText,l.value]]),e.createElementVNode("button",{class:"btn btn-primary",onClick:d},"添加")]),e.createElementVNode("view",{class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["item",{active:t.id===n.value.currentId}])},[e.createElementVNode("view",{class:"name",onClick:e=>(i(t.id),u(),void uni.showToast({title:"已切换",icon:"success"}))},e.toDisplayString(t.name),9,["onClick"]),e.createElementVNode("view",{class:"ops"},[e.createElementVNode("button",{class:"mini",onClick:e=>v(t)},"改名",8,["onClick"]),e.createElementVNode("button",{class:"mini danger",onClick:e=>p(t.id)},"删除",8,["onClick"])])],2)))),128))])]))}},[["__scopeId","data-v-624f5059"]]),E=m({__name:"index",setup(t){const a=e.ref([]);function r(){try{uni.switchTab({url:"/pages/user/index"})}catch(e){}}return e.onMounted((()=>{o(),function(){const e=function(){const e=s().list||[],t=l(n,{});return e.map((e=>{const n=(t[e.id]||{totals:{total:0,success:0,fail:0},days:{}}).totals||{total:0,success:0,fail:0},l=n.total?Math.round(n.success/n.total*100):0;return{id:e.id,name:e.name,totals:n,winRate:l}}))}();e.sort(((e,t)=>t.winRate-e.winRate||t.totals.total-e.totals.total)),a.value=e}()})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"page",style:{padding:"24rpx",display:"flex","flex-direction":"column",gap:"18rpx"}},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"row",style:{"justify-content":"space-between","align-items":"center"}},[e.createElementVNode("text",{class:"title"},"玩家总览"),e.createElementVNode("button",{class:"btn mini",onClick:r},"管理用户")]),e.createElementVNode("view",{class:"table"},[e.createElementVNode("view",{class:"thead"},[e.createElementVNode("text",{class:"th rank"},"#"),e.createElementVNode("text",{class:"th user"},"用户"),e.createElementVNode("text",{class:"th"},"总局"),e.createElementVNode("text",{class:"th ok"},"成功"),e.createElementVNode("text",{class:"th fail"},"失败"),e.createElementVNode("text",{class:"th"},"胜率")]),e.createElementVNode("view",{class:"tbody"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"tr",key:t.id},[e.createElementVNode("text",{class:"td rank"},e.toDisplayString(n+1),1),e.createElementVNode("text",{class:"td user"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"td"},e.toDisplayString(t.totals.total),1),e.createElementVNode("text",{class:"td ok"},e.toDisplayString(t.totals.success),1),e.createElementVNode("text",{class:"td fail"},e.toDisplayString(t.totals.fail),1),e.createElementVNode("text",{class:"td"},e.toDisplayString(t.winRate)+"%",1)])))),128))])])])]))}},[["__scopeId","data-v-fbebd2d4"]]);__definePage("pages/login/index",f),__definePage("pages/index/index",k),__definePage("pages/user/index",w),__definePage("pages/stats/index",E);const b={onLaunch(){},onShow(){},onHide(){}};const{app:V,Vuex:N,Pinia:S}={app:e.createVueApp(b)};uni.Vuex=N,uni.Pinia=S,V.provide("__globalStyles",__uniConfig.styles),V._component.mpType="app",V._component.render=()=>{},V.mount("#app")}(Vue);
