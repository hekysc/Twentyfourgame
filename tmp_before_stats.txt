<template>
  <view class="page col" :class="{ booted }" style="padding: 24rpx; padding-top: 24rpx; gap: 24rpx; position: relative;">

    <!-- å½“å‰ç”¨æˆ·ä¸åˆ‡æ?-->
    <view class="topbar" style="display:flex; align-items:center; justify-content:space-between; gap:12rpx; background:transparent; border:none;">
      <text class="topbar-title" style="text-align:left; flex:1;">å½“å‰ç”¨æˆ·ï¼š{{ currentUser && currentUser.name ? currentUser.name : 'æœªé€‰æ‹©' }}</text>
      <button class="btn btn-secondary" style="padding:16rpx 20rpx; width:auto;" @click="goLogin">åˆ‡æ¢ç”¨æˆ·</button>
    </view>

    <!-- ç‰ŒåŒºï¼šå››å¼ å¡ç‰‡ç­‰å®½å æ»¡ä¸€è¡Œï¼ˆæ¯å¼ å¡ç‰‡å•ç‹¬è®¡æ•°ï¼?-->
    <view id="cardGrid" class="card-grid" style="padding-top: 50rpx;">
      <view v-for="(card, idx) in cards" :key="idx"
            class="card"
            :class="{ used: (usedByCard[idx]||0) > 0 }"
            @touchstart.stop.prevent="startDrag({ type: 'num', value: String(card.rank), rank: card.rank, suit: card.suit, cardIndex: idx }, $event)"
            @touchmove.stop.prevent="onDrag($event)"
            @touchend.stop.prevent="endDrag()">
        <image class="card-img" :src="cardImage(card)" mode="widthFix"/>
      </view>
    </view>

    <!-- æœ¬å±€ç»Ÿè®¡ï¼ˆç‰Œå ?+ èƒœè´Ÿï¼?-->
    <view class="stats-card">
      <view class="stats-row">
        <text class="stat-label">å‰©ä½™æ‰‘å…‹</text>
        <text class="stat-value">{{ remainingCards }}</text>
